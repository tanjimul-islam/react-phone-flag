<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>React Phone Flag Selector - Modern Demo</title>
    <style>
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          sans-serif;
        margin: 0;
        padding: 40px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
      }

      .demo-container {
        background: white;
        border-radius: 20px;
        padding: 40px;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        max-width: 500px;
        width: 100%;
      }

      .demo-title {
        text-align: center;
        margin-bottom: 30px;
        color: #1d1d1f;
      }

      .demo-title h1 {
        margin: 0 0 10px 0;
        font-size: 28px;
        font-weight: 600;
      }

      .demo-title p {
        margin: 0;
        color: #86868b;
        font-size: 16px;
      }

      .demo-section {
        margin-bottom: 30px;
      }

      .demo-section h3 {
        margin: 0 0 15px 0;
        color: #1d1d1f;
        font-size: 18px;
        font-weight: 500;
      }

      .demo-section p {
        margin: 0 0 15px 0;
        color: #86868b;
        font-size: 14px;
      }

      .output {
        background: #f8f9fa;
        border: 1px solid #e1e5e9;
        border-radius: 8px;
        padding: 12px;
        margin-top: 15px;
        font-family: "Monaco", "Menlo", monospace;
        font-size: 12px;
        color: #1d1d1f;
        min-height: 20px;
      }

      .feature-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin-top: 20px;
      }

      .feature-card {
        background: #f8f9fa;
        border-radius: 12px;
        padding: 20px;
        text-align: center;
      }

      .feature-card h4 {
        margin: 0 0 10px 0;
        color: #1d1d1f;
        font-size: 16px;
      }

      .feature-card p {
        margin: 0;
        color: #86868b;
        font-size: 14px;
      }
    </style>
  </head>
  <body>
    <div class="demo-container">
      <div class="demo-title">
        <h1>üá´üá∑ React Phone Flag Selector</h1>
        <p>Modern, clean country code selector with flags</p>
      </div>

      <div class="demo-section">
        <h3>üì± Phone Number Input</h3>
        <p>Complete phone input with country selection</p>
        <div id="phone-demo"></div>
        <div class="output" id="phone-output">
          Select a country and enter a phone number...
        </div>
      </div>

      <div class="demo-section">
        <h3>üè≥Ô∏è Country Code Selector</h3>
        <p>Standalone country code selector</p>
        <div id="country-demo"></div>
        <div class="output" id="country-output">Select a country...</div>
      </div>

      <div class="feature-grid">
        <div class="feature-card">
          <h4>üé® Modern Design</h4>
          <p>Clean, rounded corners with smooth animations</p>
        </div>
        <div class="feature-card">
          <h4>üîç Smart Search</h4>
          <p>Search by country name, code, or dial code</p>
        </div>
        <div class="feature-card">
          <h4>üì± Responsive</h4>
          <p>Works perfectly on mobile and desktop</p>
        </div>
        <div class="feature-card">
          <h4>üåô Dark Mode</h4>
          <p>Automatic dark mode support</p>
        </div>
      </div>
    </div>

    <!-- React and ReactDOM -->
    <script
      crossorigin
      src="https://unpkg.com/react@18/umd/react.development.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"
    ></script>

    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Modern CSS Styles -->
    <style>
      /* Modern Phone Flag Selector Styles */
      .phone-flag-selector {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          sans-serif;
        width: 100%;
        max-width: 400px;
      }

      .phone-input-container {
        display: flex;
        align-items: center;
        background: #ffffff;
        border: 1px solid #e1e5e9;
        border-radius: 12px;
        padding: 0;
        transition: all 0.2s ease;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
      }

      .phone-input-container:focus-within {
        border-color: #007aff;
        box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.1);
      }

      /* Country Code Selector Styles */
      .country-code-selector {
        position: relative;
        min-width: 120px;
      }

      .selector-trigger {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 12px 16px;
        cursor: pointer;
        user-select: none;
        border-right: 1px solid #e1e5e9;
        transition: background-color 0.2s ease;
      }

      .selector-trigger:hover {
        background-color: #f8f9fa;
      }

      .selector-trigger.open {
        background-color: #f8f9fa;
      }

      .selector-trigger.disabled {
        opacity: 0.6;
        cursor: not-allowed;
      }

      .selected-country {
        display: flex;
        align-items: center;
        gap: 8px;
        min-width: 0;
      }

      .flag {
        width: 20px;
        height: 15px;
        border-radius: 2px;
        object-fit: cover;
        flex-shrink: 0;
        font-size: 15px;
        line-height: 1;
      }

      .dial-code {
        font-weight: 500;
        color: #1d1d1f;
        font-size: 14px;
        white-space: nowrap;
      }

      .arrow {
        color: #86868b;
        font-size: 10px;
        transition: transform 0.2s ease;
        margin-left: auto;
      }

      .selector-trigger.open .arrow {
        transform: rotate(180deg);
      }

      /* Phone Input Styles */
      .phone-input {
        flex: 1;
        border: none;
        outline: none;
        padding: 12px 16px;
        font-size: 16px;
        color: #1d1d1f;
        background: transparent;
        min-width: 0;
      }

      .phone-input::placeholder {
        color: #86868b;
      }

      .phone-input:disabled {
        opacity: 0.6;
        cursor: not-allowed;
      }

      /* Dropdown Styles */
      .dropdown {
        position: absolute;
        top: 100%;
        left: 0;
        right: 0;
        background: #ffffff;
        border: 1px solid #e1e5e9;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        z-index: 1000;
        margin-top: 4px;
        max-height: 300px;
        overflow: hidden;
      }

      .search-container {
        padding: 12px 16px;
        border-bottom: 1px solid #f0f0f0;
        background: #fafafa;
      }

      .search-input {
        width: 100%;
        border: 1px solid #e1e5e9;
        border-radius: 6px;
        padding: 8px 12px 8px 36px;
        font-size: 14px;
        outline: none;
        transition: border-color 0.2s ease;
        background: #ffffff
          url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23999' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='11' cy='11' r='8'%3E%3C/circle%3E%3Cpath d='m21 21-4.35-4.35'%3E%3C/path%3E%3C/svg%3E")
          no-repeat 12px center;
        background-size: 16px;
      }

      .search-input:focus {
        border-color: #007aff;
        box-shadow: 0 0 0 2px rgba(0, 122, 255, 0.1);
      }

      .search-input::placeholder {
        color: #999;
        font-size: 14px;
      }

      .countries-list {
        max-height: 250px;
        overflow-y: auto;
        scrollbar-width: thin;
        scrollbar-color: #e1e5e9 transparent;
      }

      .countries-list::-webkit-scrollbar {
        width: 4px;
      }

      .countries-list::-webkit-scrollbar-track {
        background: transparent;
      }

      .countries-list::-webkit-scrollbar-thumb {
        background: #e1e5e9;
        border-radius: 2px;
      }

      .country-option {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 10px 16px;
        cursor: pointer;
        transition: background-color 0.15s ease;
        border-bottom: 1px solid #f8f9fa;
        font-size: 14px;
        color: #333;
      }

      .country-option:last-child {
        border-bottom: none;
      }

      .country-option:hover {
        background-color: #f5f5f5;
      }

      .country-option.selected {
        background-color: #f0f8ff;
        color: #007aff;
      }

      .country-option.selected .dial-code {
        color: #007aff;
      }

      .country-name {
        flex: 1;
        font-size: 14px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        font-weight: 400;
      }

      .no-results {
        padding: 16px;
        text-align: center;
        color: #999;
        font-size: 14px;
        font-style: italic;
      }

      /* Responsive Design */
      @media (max-width: 480px) {
        .phone-input-container {
          border-radius: 8px;
        }

        .selector-trigger {
          padding: 10px 12px;
        }

        .phone-input {
          padding: 10px 12px;
          font-size: 16px;
        }

        .dial-code {
          font-size: 13px;
        }

        .flag {
          width: 18px;
          height: 14px;
        }
      }

      /* Dark mode support */
      @media (prefers-color-scheme: dark) {
        .phone-input-container {
          background: #1c1c1e;
          border-color: #38383a;
        }

        .phone-input {
          color: #ffffff;
        }

        .phone-input::placeholder {
          color: #8e8e93;
        }

        .dial-code {
          color: #ffffff;
        }

        .dropdown {
          background: #1c1c1e;
          border-color: #38383a;
        }

        .country-option {
          border-bottom-color: #2c2c2e;
        }

        .country-option:hover {
          background-color: #2c2c2e;
        }

        .search-input {
          background: #2c2c2e;
          border-color: #38383a;
          color: #ffffff;
        }

        .search-input::placeholder {
          color: #8e8e93;
        }
      }
    </style>

    <!-- Component Code -->
    <script type="text/babel">
      const { useState, useEffect, useRef } = React;

      // Country data
      const countryData = [
        { name: "France", code: "FR", dialCode: "+33", flag: "üá´üá∑" },
        { name: "United States", code: "US", dialCode: "+1", flag: "üá∫üá∏" },
        { name: "United Kingdom", code: "GB", dialCode: "+44", flag: "üá¨üáß" },
        { name: "Germany", code: "DE", dialCode: "+49", flag: "üá©üá™" },
        { name: "Spain", code: "ES", dialCode: "+34", flag: "üá™üá∏" },
        { name: "Italy", code: "IT", dialCode: "+39", flag: "üáÆüáπ" },
        { name: "Canada", code: "CA", dialCode: "+1", flag: "üá®üá¶" },
        { name: "Australia", code: "AU", dialCode: "+61", flag: "üá¶üá∫" },
        { name: "Japan", code: "JP", dialCode: "+81", flag: "üáØüáµ" },
        { name: "China", code: "CN", dialCode: "+86", flag: "üá®üá≥" },
        { name: "India", code: "IN", dialCode: "+91", flag: "üáÆüá≥" },
        { name: "Brazil", code: "BR", dialCode: "+55", flag: "üáßüá∑" },
        { name: "Mexico", code: "MX", dialCode: "+52", flag: "üá≤üáΩ" },
        { name: "South Korea", code: "KR", dialCode: "+82", flag: "üá∞üá∑" },
        { name: "Netherlands", code: "NL", dialCode: "+31", flag: "üá≥üá±" },
        { name: "Sweden", code: "SE", dialCode: "+46", flag: "üá∏üá™" },
        { name: "Norway", code: "NO", dialCode: "+47", flag: "üá≥üá¥" },
        { name: "Denmark", code: "DK", dialCode: "+45", flag: "üá©üá∞" },
        { name: "Finland", code: "FI", dialCode: "+358", flag: "üá´üáÆ" },
        { name: "Switzerland", code: "CH", dialCode: "+41", flag: "üá®üá≠" },
      ];

      // Flag Component
      const Flag = ({
        countryCode,
        emoji,
        useImages = false,
        size = 16,
        className = "",
      }) => {
        const [imageError, setImageError] = useState(false);

        if (useImages && !imageError) {
          return (
            <img
              src={`https://flagcdn.com/w${size}.svg`}
              alt={`${countryCode} flag`}
              className={`flag ${className}`}
              style={{ width: size, height: size * 0.75 }}
              onError={() => setImageError(true)}
            />
          );
        }

        return (
          <span
            className={`flag ${className}`}
            style={{ fontSize: size * 0.75 }}
          >
            {emoji}
          </span>
        );
      };

      // Country Code Selector Component
      const CountryCodeSelector = ({
        value,
        onChange,
        className = "",
        disabled = false,
        searchable = true,
        showFlag = true,
        showDialCode = true,
        useFlagImages = false,
        flagSize = 16,
        defaultCountry = "FR",
        preferredCountries = [],
        excludeCountries = [],
        dropdownProps = {},
      }) => {
        const [isOpen, setIsOpen] = useState(false);
        const [searchTerm, setSearchTerm] = useState("");
        const [selectedCountry, setSelectedCountry] = useState(
          countryData.find((country) => country.code === defaultCountry)
        );
        const dropdownRef = useRef(null);

        useEffect(() => {
          if (value) {
            setSelectedCountry(value);
          }
        }, [value]);

        useEffect(() => {
          const handleClickOutside = (event) => {
            if (
              dropdownRef.current &&
              !dropdownRef.current.contains(event.target)
            ) {
              setIsOpen(false);
            }
          };

          document.addEventListener("mousedown", handleClickOutside);
          return () =>
            document.removeEventListener("mousedown", handleClickOutside);
        }, []);

        const filteredCountries = countryData.filter((country) => {
          const matchesSearch =
            !searchTerm ||
            country.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
            country.dialCode.includes(searchTerm) ||
            country.code.toLowerCase().includes(searchTerm.toLowerCase());
          const notExcluded = !excludeCountries.includes(country.code);
          return matchesSearch && notExcluded;
        });

        const sortedCountries = [...filteredCountries].sort((a, b) => {
          const aPreferred = preferredCountries.includes(a.code);
          const bPreferred = preferredCountries.includes(b.code);
          if (aPreferred && !bPreferred) return -1;
          if (!aPreferred && bPreferred) return 1;
          return a.name.localeCompare(b.name);
        });

        const handleCountrySelect = (country) => {
          setSelectedCountry(country);
          setIsOpen(false);
          setSearchTerm("");
          onChange?.(country);
        };

        const handleToggle = () => {
          if (!disabled) {
            setIsOpen(!isOpen);
            if (!isOpen) {
              setSearchTerm("");
            }
          }
        };

        return (
          <div
            className={`country-code-selector ${className}`}
            ref={dropdownRef}
          >
            <div
              className={`selector-trigger ${disabled ? "disabled" : ""} ${
                isOpen ? "open" : ""
              }`}
              onClick={handleToggle}
            >
              {selectedCountry && (
                <div className="selected-country">
                  {showFlag && (
                    <Flag
                      countryCode={selectedCountry.code}
                      emoji={selectedCountry.flag}
                      useImages={useFlagImages}
                      size={flagSize}
                      className="flag"
                    />
                  )}
                  {showDialCode && (
                    <span className="dial-code">
                      {selectedCountry.dialCode}
                    </span>
                  )}
                </div>
              )}
              <span className="arrow">‚ñº</span>
            </div>

            {isOpen && (
              <div className="dropdown" {...dropdownProps}>
                {searchable && (
                  <div className="search-container">
                    <input
                      type="text"
                      placeholder="Search countries..."
                      value={searchTerm}
                      onChange={(e) => setSearchTerm(e.target.value)}
                      className="search-input"
                      autoFocus
                    />
                  </div>
                )}

                <div className="countries-list">
                  {sortedCountries.length > 0 ? (
                    sortedCountries.map((country) => (
                      <div
                        key={country.code}
                        className={`country-option ${
                          selectedCountry?.code === country.code
                            ? "selected"
                            : ""
                        }`}
                        onClick={() => handleCountrySelect(country)}
                      >
                        {showFlag && (
                          <Flag
                            countryCode={country.code}
                            emoji={country.flag}
                            useImages={useFlagImages}
                            size={flagSize}
                            className="flag"
                          />
                        )}
                        <span className="country-name">{country.name}</span>
                        {showDialCode && (
                          <span className="dial-code">{country.dialCode}</span>
                        )}
                      </div>
                    ))
                  ) : (
                    <div className="no-results">No countries found</div>
                  )}
                </div>
              </div>
            )}
          </div>
        );
      };

      // Phone Flag Selector Component
      const PhoneFlagSelector = ({
        value = "",
        onChange,
        placeholder = "Enter phone number",
        className = "",
        disabled = false,
        searchable = true,
        showFlag = true,
        showDialCode = true,
        useFlagImages = false,
        flagSize = 16,
        defaultCountry = "FR",
        preferredCountries = [],
        excludeCountries = [],
        inputProps = {},
        dropdownProps = {},
      }) => {
        const [phoneNumber, setPhoneNumber] = useState(value);
        const [selectedCountry, setSelectedCountry] = useState(
          countryData.find((country) => country.code === defaultCountry)
        );

        useEffect(() => {
          setPhoneNumber(value);
        }, [value]);

        const handlePhoneChange = (e) => {
          const newValue = e.target.value;
          setPhoneNumber(newValue);
          const fullNumber = selectedCountry
            ? `${selectedCountry.dialCode}${newValue}`
            : newValue;
          onChange?.(fullNumber, selectedCountry);
        };

        const handleCountryChange = (country) => {
          setSelectedCountry(country);
          const fullNumber = `${country.dialCode}${phoneNumber}`;
          onChange?.(fullNumber, country);
        };

        const displayPhoneNumber =
          selectedCountry && phoneNumber.startsWith(selectedCountry.dialCode)
            ? phoneNumber.substring(selectedCountry.dialCode.length)
            : phoneNumber;

        return (
          <div className={`phone-flag-selector ${className}`}>
            <div className="phone-input-container">
              <CountryCodeSelector
                value={selectedCountry}
                onChange={handleCountryChange}
                disabled={disabled}
                searchable={searchable}
                showFlag={showFlag}
                showDialCode={showDialCode}
                useFlagImages={useFlagImages}
                flagSize={flagSize}
                defaultCountry={defaultCountry}
                preferredCountries={preferredCountries}
                excludeCountries={excludeCountries}
                dropdownProps={dropdownProps}
              />
              <input
                type="tel"
                value={displayPhoneNumber}
                onChange={handlePhoneChange}
                placeholder={placeholder}
                disabled={disabled}
                className="phone-input"
                {...inputProps}
              />
            </div>
          </div>
        );
      };

      // Demo App
      const DemoApp = () => {
        const [phoneValue, setPhoneValue] = useState("+33123456789");
        const [countryValue, setCountryValue] = useState(
          countryData.find((c) => c.code === "FR")
        );

        return (
          <div>
            <PhoneFlagSelector
              value={phoneValue}
              onChange={(phone, country) => {
                setPhoneValue(phone);
                document.getElementById(
                  "phone-output"
                ).textContent = `Phone: ${phone} | Country: ${country?.name} (${country?.code})`;
              }}
              placeholder="Enter your phone number"
              defaultCountry="FR"
            />

            <CountryCodeSelector
              value={countryValue}
              onChange={(country) => {
                setCountryValue(country);
                document.getElementById(
                  "country-output"
                ).textContent = `Selected: ${country?.name} (${country?.code}) - ${country?.dialCode}`;
              }}
              defaultCountry="FR"
            />
          </div>
        );
      };

      // Render the demo
      ReactDOM.render(<DemoApp />, document.getElementById("phone-demo"));
      ReactDOM.render(
        <CountryCodeSelector
          value={countryData.find((c) => c.code === "FR")}
          onChange={(country) => {
            document.getElementById(
              "country-output"
            ).textContent = `Selected: ${country?.name} (${country?.code}) - ${country?.dialCode}`;
          }}
          defaultCountry="FR"
        />,
        document.getElementById("country-demo")
      );
    </script>
  </body>
</html>
